% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/matrixCoOcurr.R
\name{matrixCoOcurr}
\alias{matrixCoOcurr}
\title{Test for co-occurrence of features in a matrix}
\usage{
matrixCoOcurr(M, covars = NULL)
}
\arguments{
\item{M}{A matrix or data frame where rows represent cases and columns represent
features.}

\item{covars}{An optional matrix or data frame of covariates, where rows represent
cases and columns are variables wanting to be included as covariates. Needs to have
the same rownames as \code{M}.}
}
\value{
A list containing the following elements:
\describe{
\item{result_summary}{A data frame summarizing the co-occurrence results}
\item{or_matrix}{A matrix of odds ratios}
\item{or_lower_matrix}{A matrix of lower bounds for odds ratio confidence intervals}
\item{or_upper_matrix}{A matrix of upper bounds for odds ratio confidence intervals}
\item{p_matrix}{A matrix of p-values}
\item{padj_matrix}{A matrix of adjusted p-values}
\item{prop_matrix}{A matrix of co-occurrence proportions}
}
}
\description{
This function calculates a co-occurrence matrix for a given set of features,
optionally adjusting for covariates.
}
\details{
The function calculates odds ratios, confidence intervals, p-values, and
proportions of co-occurrence for all pairs of features in the input matrix.
If covariates are provided, the function uses logistic regression (via the
\code{logistf} package) to adjust for these covariates. Otherwise, it uses Fisher's
exact test.

The function efficiently handles comparing features to themselves.

P-values are adjusted for multiple testing using the Benjamini-Hochberg method
(\code{p.adjust(..., method = 'BH')}).
}
\note{
This function requires the \code{logistf} package to be installed.
Case names in \code{M} and \code{covars} must match exactly if providing covariates.
}
\examples{
M <- matrix(rbinom(1000, 1, 0.5), ncol = 10)
colnames(M) <- paste0("Feature", 1:10)
result <- matrixCoOcurr(M)

}
